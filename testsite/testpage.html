<html>
<head>
	<title>MiniMask Extension</title>
	
		
</head>
<body>

	<style>
		table {
			border: 1px solid black;
			border-collapse: collapse;
		}
		td {
			border: 1px solid white;
		  	background-color: red;
		  	padding: 2;
		}
	</style>
	
	Hello..	
	
	<button onclick='getBlock();'>Click Me</button>
	
	
	<br><br>
	<table id="id_balance_table" style="width:200;background-color:red;"></table>
	
<script type="text/javascript">
	
	/**
	 * Make a POST request
	 */
	async function makeGenericPostRequest(url, params, userpass, callback){
			
		let headers = new Headers();
		headers.append('Authorization', 'Basic ' + btoa(userpass));
		headers.append('Content-Type', 'application/x-www-form-urlencoded');
		
		var dat = {};
		dat.address = "0xFF";	
		
		const response = await fetch(url, {
		  method: "POST",
		  headers: headers,
		  body: "address=0xFF",
		  // …
		});
		
		if (!response.ok) {
	      
	    }

		//Wait for the response
	    //const result = await response.text();
		const result = await response.json();
		
		//Send result back
		callback(result) ;
	}
	
	function setBalance(resp){
		
		var baltable = document.getElementById("id_balance_table");
		for(var i=0;i<resp.data.length;i++){
			var balance = resp.data[i];
			
			var row 	= baltable.insertRow();
			var cell1 	= row.insertCell(0);
			var cell2 	= row.insertCell(1);
			
			//The name
			var name;
			if(balance.tokenid=="0x00"){
				name = document.createTextNode("Minima");
			}else{
				name = document.createTextNode(balance.token.name);
			}
			cell1.appendChild(name);
			   
			//The amount
			cell2.innerHTML = balance.confirmed;
		}
		
	}
	
	function getBlock(){
		/*MINIMASK.block(function(resp){
			console.log("TESTPAGE BLOCK : "+JSON.stringify(resp));	
		});*/
		
		/*MINIMASK.create(function(resp){
			console.log("TESTPAGE CREATE : "+JSON.stringify(resp));	
		});*/
		
		MINIMASK.account.balance(function(resp){
			console.log("TESTPAGE BALANCE : "+JSON.stringify(resp));
			
			setBalance(resp);
		});
		
		/*MINIMASK.account.send("0.001", "0xFF", "0x00", function(resp){
			console.log("TESTPAGE SEND : "+JSON.stringify(resp));	
		});*/
	}
	
		
	//Wait for page to load
	window.onload = function () {
		
		//Initialise MiniMask
		MINIMASK.init(function(){});
		
		//testerFunction();
		getBlock();
		
		/*makeGenericPostRequest("http://127.0.0.1:8080/wallet/balance",{},"apicaller:apicaller",function(resp){
			console.log("TEST POST : "+JSON.stringify(resp));
		});*/	
	}

	/*async function makePostRequest(url, params, callback){
		
		let headers = new Headers();
		headers.append('Authorization', 'Basic ' + btoa("apicaller:apicaller"));
		
		const response = await fetch(url, {
		  method: "POST",
		  headers: headers,
		  body: JSON.stringify(params),
		  // …
		});
		
		if (!response.ok) {
	      
	    }

		//Wait for the response
	    const result = await response.text();
		
		//Send result back
		callback(result) ;
	}*/
		
</script>
		
</body>	


</html>